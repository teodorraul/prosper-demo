"use strict";(self.webpackChunkprosper_demo=self.webpackChunkprosper_demo||[]).push([[559],{559:function(e,t,r){r.r(t),r.d(t,{default:function(){return Se}});var n=r(4015),o=(r(1111),r(6540)),i=r(7767),a=r(9241),l=r(1627),c=r(481),s=r(2317),u=r(3713),d="_1mh5klk1",f=r(9318),v=r(7813);function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?e.charAt(0).toUpperCase()+e.slice(1)+(t?".":""):t?".":""}var y=function(e){var t=(0,o.useMemo)((function(){var t;return m((null!==(t=null==e?void 0:e.nodeName)&&void 0!==t?t:"Unnamed node").replaceAll("_"," ").trim())}),[null==e?void 0:e.nodeName]),r=(0,o.useMemo)((function(){var t,r,n=null!==(t=null==e?void 0:e.nodeEnterCondition)&&void 0!==t?t:"";return m(((null===(r=n.split("user")[1])||void 0===r?void 0:r.split(", call this")[0])||n).trim(),!0)}),[null==e?void 0:e.nodeEnterCondition]);return(0,o.useMemo)((function(){return{formattedTitle:t,formattedDescription:r}}),[t,r])},p=function(e){var t=(0,s.P)();return(0,v.EW)((function(){return e?t.agentEditor.nodeDetails.get(e):void 0})).get()},b="#ccc",h=r(4848);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var E=(0,n.PA)((function(e){e.id;var t,r,n=e.sourceX,o=e.sourceY,i=e.targetX,a=e.targetY,l=e.sourcePosition,c=e.targetPosition,s=e.style,d=void 0===s?{}:s,v=(e.selected,e.markerEnd),m=(t=(0,f.oN)({sourceX:n,sourceY:o,sourcePosition:l,targetX:i,targetY:a,targetPosition:c,borderRadius:20}),r=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=m[0];return m[1],m[2],(0,h.jsx)("g",{className:"prevent-selection-loss",children:(0,h.jsx)(u.tE,{path:y,markerEnd:v,interactionWidth:20,style:x(x({},d),{},{stroke:b})})})})),P=r(6708),N=(0,P.c)({defaultClassName:"_8jra301",variantClassNames:{selected:{true:"_8jra302",false:"_8jra303"}},defaultVariants:{},compoundVariants:[]}),S=(0,P.c)({defaultClassName:"_8jra305",variantClassNames:{selected:{true:"_8jra306",false:"_8jra307"}},defaultVariants:{},compoundVariants:[]}),k="chno9g5",C=(0,n.PA)((function(e){var t=e.nodeId,r=e.needsEnding,n=(0,s.P)(),o=p(t),i=(0,v.EW)((function(){var e;return(null===(e=n.agentEditor.hoveredNode)||void 0===e?void 0:e.id)==t?n.agentEditor.hoveredNode.side:void 0})).get(),l=(0,c.S)("side",(function(e,r){r.stopPropagation(),n.agentEditor.insertNode(t,e)}),[t]),u="start_call"==(null==o?void 0:o.nodeType)||"default"==(null==o?void 0:o.nodeType);return(0,h.jsxs)("div",{className:"chno9g0",children:["left"===i&&(0,h.jsx)("div",{className:"chno9g2",children:(0,h.jsx)(a.$,{circle:!0,"data-side":"left",title:"+",className:k,action:l})}),"right"===i&&(0,h.jsx)("div",{className:"chno9g4",children:(0,h.jsx)(a.$,{"data-side":"right",circle:!0,title:"+",className:k,action:l})}),u&&r&&(0,h.jsx)("div",{className:"chno9g1",children:(0,h.jsx)(a.$,{"data-side":"center",circle:!0,title:"Add End Call Node",className:"chno9g3",action:l})})]})})),_=function(e){return e.id?e.id:e.data_type+e.description+e.name},D="t3zkrt2",A=r(6693),I=function(e){var t=e.items,r=void 0===t?[]:t;return(0,h.jsxs)("div",{className:"t3zkrt0",children:[(0,h.jsx)(A.E,{level:"microtitle",children:"Extract Data"}),r.map((function(e){var t;return(0,h.jsxs)("div",{className:"t3zkrt1",children:[(0,h.jsx)("span",{className:"".concat(D," ").concat("t3zkrt3"),children:null===(t=e.dataType)||void 0===t?void 0:t[0]}),(0,h.jsx)("span",{className:"t3zkrt4",children:m(e.name.replaceAll("_"," "))})]},_(e))}))]})},T=function(e){var t=e.expanded;return(0,h.jsx)("span",{className:"_1bcdjcw0",children:t?"EXECUTE ONLY IF:":"IF"})},V=(0,n.PA)((function(e){var t,r=e.nodeId,n=p(r),o=y(n),i=o.formattedTitle,a=o.formattedDescription,l=""==(null==n?void 0:n.nodeEnterCondition);return(0,h.jsxs)("div",{className:"node-container",children:[(0,h.jsx)(A.E,{level:"title",ctx:"node",color:i?"text":"barelyVisible",children:i||"Untitled Function"}),(0,h.jsxs)("div",{className:"_8jra304",children:[(0,h.jsx)(T,{}),(0,h.jsx)(A.E,{level:"body",ctx:"node",color:l?"barelyVisible":"subtle",children:l?"Always executes.":a})]}),(null==n||null===(t=n.userData)||void 0===t?void 0:t.length)>0&&(0,h.jsx)(I,{items:null==n?void 0:n.userData})]})})),L=function(e){var t=e.type,r=e.className;return"phone"==t?(0,h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:r,children:(0,h.jsx)("path",{fillRule:"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z",clipRule:"evenodd"})}):"xmark"==t?(0,h.jsxs)("svg",{width:"12",height:"11",viewBox:"0 0 12 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:r,children:[(0,h.jsx)("line",{x1:"1.37959",y1:"1.29289",x2:"10.3796",y2:"10.2929",stroke:"currentColor",strokeWidth:"2"}),(0,h.jsx)("line",{y1:"-1",x2:"12.7279",y2:"-1",transform:"matrix(-0.707107 0.707107 0.707107 0.707107 11 2)",stroke:"currentColor",strokeWidth:"2"})]}):"selector"==t?(0,h.jsxs)("svg",{width:"12",height:"24",viewBox:"0 0 12 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:r,children:[(0,h.jsx)("path",{d:"M6 4L2 9H10L6 4Z",fill:"black"}),(0,h.jsx)("path",{d:"M6 20L10 15H2L6 20Z",fill:"black"})]}):"shutdown"==t?(0,h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"})}):(0,h.jsx)(h.Fragment,{})},z=(0,n.PA)((function(e){var t=e.nodeId,r=p(t),n=y(r),o=n.formattedTitle,i=n.formattedDescription;return(0,h.jsxs)("div",{className:"_151js6v1",children:[(0,h.jsx)(L,{type:"shutdown",className:"_151js6v0"}),(0,h.jsx)(A.E,{level:"title",ctx:"node",children:o}),(0,h.jsx)("div",{className:"_151js6v2",children:(0,h.jsx)(A.E,{level:"body",ctx:"node",color:"subtle",children:i})}),(0,h.jsx)(I,{items:null==r?void 0:r.userData})]})})),F=(0,n.PA)((function(e){e.nodeId;var t=(0,s.P)().agentEditor.prompt;return(0,h.jsxs)("div",{className:"_4c8h6s3",children:[(0,h.jsxs)("div",{className:"_4c8h6s4",children:[(0,h.jsx)(L,{type:"phone",className:"_4c8h6s2"}),(0,h.jsx)(A.E,{level:"title",ctx:"node",children:"Call Start"})]}),t?(0,h.jsx)(A.E,{level:"body",ctx:"node",pre:!0,children:t}):(0,h.jsx)(A.E,{color:"subtle",children:"Start by setting a prompt."})]})})),M=["id","data","selected"],U=(0,n.PA)((function(e){var t=e.id,r=e.data,n=(e.selected,function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}}(e,M),p(t)),i=(0,s.P)().agentEditor.selectedNode===t,a=(0,o.useMemo)((function(){switch(null==n?void 0:n.nodeType){case"start_call":return(0,h.jsx)(F,{nodeId:t});case"end_call":return(0,h.jsx)(z,{nodeId:t});case"default":return(0,h.jsx)(V,{node:n,nodeId:t});case"global":case void 0:return(0,h.jsx)(h.Fragment,{});default:throw new Error("unsupported node type: "+(null==n?void 0:n.nodeType))}}),[null==n?void 0:n.nodeType,t]);return(0,h.jsx)("div",{className:"".concat("_8jra300"," rendered-node"),"data-node-id":t,children:(0,h.jsxs)("div",{className:N({selected:i}),children:[(0,h.jsx)(u.h7,{type:"source",position:f.yX.Bottom,style:{visibility:"hidden"}}),a,(0,h.jsx)("div",{className:S({selected:i})}),(0,h.jsx)(u.h7,{type:"target",position:f.yX.Top,style:{visibility:"hidden"}}),"end_call"==(null==n?void 0:n.nodeType)?(0,h.jsx)(h.Fragment,{}):(0,h.jsx)(C,{nodeId:t,needsEnding:r.needsEnding})]})})})),R=(r(4734),"_16xqro33"),q=r(3829),B=(0,P.c)({defaultClassName:"i9xonl0",variantClassNames:{},defaultVariants:{},compoundVariants:[]});function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}var $=["onClick"];function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function H(e,t,r){return(t=function(e){var t=function(e){if("object"!=X(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Y=function(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,$);return(0,h.jsx)("div",W(W({className:B(),onClick:t},r),{},{children:(0,h.jsx)(L,{type:"xmark",className:"i9xonl1"})}))},Z=function(e){var t=e.value;return(0,h.jsxs)("div",{className:"_1oq1udv0",children:[(0,h.jsx)("span",{className:"".concat(D," ").concat("_1oq1udv1"),children:null==t?void 0:t[0]}),(0,h.jsx)(A.E,{children:m(t)}),(0,h.jsx)(L,{type:"selector",className:"_1oq1udv2"})]})},G=(0,P.c)({defaultClassName:"_1osctke4",variantClassNames:{context:{default:"_1osctke5",editorSidebar:"_1osctke6",editorSidebarCard:"_1osctke7"}},defaultVariants:{},compoundVariants:[]}),J=(0,P.c)({defaultClassName:"_1osctke0",variantClassNames:{context:{default:"_1osctke1",editorSidebar:"_1osctke2",editorSidebarCard:"_1osctke3"}},defaultVariants:{},compoundVariants:[]});function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}var ee=["remoteValue","placeholder","autofocusIfEmpty","onChange","autofocus","onDelayedChange","className","area","context"];function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){ne(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e,t,r){return(t=function(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ie(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ie(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ae=function(e){var t=e.remoteValue,r=e.placeholder,n=e.autofocusIfEmpty,i=e.onChange,a=e.autofocus,l=e.onDelayedChange,c=e.className,s=e.area,u=e.context,d=void 0===u?"default":u,f=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,ee),v=(0,o.useRef)(null),m=oe((0,o.useState)(""),2),y=m[0],p=m[1],b=oe((0,o.useState)(!1),2),g=(b[0],b[1]),j=(0,o.useRef)(void 0),x=(0,o.useRef)(!1),w=(0,o.useRef)(!1),O=(0,o.useRef)(void 0),E=(0,o.useCallback)((function(e){p(e.target.value),null==i||i(e.target.value,e),j.current=e.target.value,O.current&&clearTimeout(O.current),O.current=setTimeout((function(){void 0!==j.current&&(null==l||l(j.current,v.current))}),800)}),[i,l]),P=(0,o.useCallback)((function(){v.current&&clearTimeout(O.current),void 0!==j.current&&(null==l||l(j.current)),g(!1),x.current=!1}),[l]),N=(0,o.useCallback)((function(){g(!0),x.current=!0}),[]);return(0,o.useEffect)((function(){x.current?void 0===j.current&&p(null!=t?t:""):t&&p(null!=t?t:"")}),[t]),(0,o.useEffect)((function(){var e,t;0==w.current&&void 0!==y&&(""==y?n&&(null===(e=v.current)||void 0===e||e.focus()):a&&(null===(t=v.current)||void 0===t||t.focus()),w.current=!0)}),[y,a,n]),(0,h.jsx)("div",{className:"_1osctke9",children:s?(0,h.jsx)("textarea",re({value:y,ref:v,placeholder:r,className:"".concat(J({context:d})," ").concat(c),onChange:E,onFocus:N,onBlur:P},f)):(0,h.jsx)("input",re({value:y,ref:v,placeholder:r,className:"".concat(G({context:d})," ").concat(c),onChange:E,onFocus:N,onBlur:P},f))})};function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){ue(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ue(e,t,r){return(t=function(e){var t=function(e){if("object"!=le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==le(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(e){return function(e){if(Array.isArray(e))return ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){if(e){if("string"==typeof e)return ve(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ve(e,t):void 0}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var me=(0,n.PA)((function(e){var t=e.userData,r=e.nodeId,n=(null==t?void 0:t.length)>0,i=(0,s.P)(),l=p(r),u=(0,o.useCallback)((function(){i.agentEditor.updateNode(r,{user_data:[{id:(0,q.A)(),data_type:"string",name:"",description:""}].concat(de((null==l?void 0:l.serializedUserDataForSupa)||[]))})}),[r,l]),d=(0,c.S)("id",(function(e){i.agentEditor.updateNode(r,{user_data:de(((null==l?void 0:l.serializedUserDataForSupa)||[]).filter((function(t){return _(t)!=e})))})}),[]),f=(0,o.useCallback)((function(e,t){var n=null==t?void 0:t.getAttribute("data-id"),o=null==t?void 0:t.getAttribute("data-field");if(n){var a=null==l?void 0:l.serializedUserDataForSupa;if(a){var c,s=void 0,u=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=fe(e))){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}(a);try{for(u.s();!(c=u.n()).done;){var d=c.value;_(d)==n&&(s=d)}}catch(e){u.e(e)}finally{u.f()}if(s){var f=a.filter((function(e){return _(e)!=n}));i.agentEditor.updateNode(r,{user_data:[se(se({},s),{},ue({},o,e))].concat(de(f||[]))})}}}}),[l]);return(0,h.jsxs)("div",{className:"_839l994",children:[(0,h.jsx)(A.E,{level:"smallTitle",color:n?"text":"barelyVisible",children:n?"Data Extraction:":""}),(0,h.jsx)("div",{className:"_839l990",children:null==t?void 0:t.map((function(e){var t=e.serializedForSupa;return(0,h.jsxs)("div",{className:"_839l991",children:[(0,h.jsx)(Z,{value:e.dataType}),(0,h.jsx)(ae,{"data-id":_(t),"data-field":"name",onDelayedChange:f,placeholder:"Variable name",context:"editorSidebar",remoteValue:e.name}),(0,h.jsx)(Y,{onClick:d,"data-id":_(t)}),(0,h.jsx)("span",{}),(0,h.jsx)(ae,{"data-field":"description","data-id":_(t),placeholder:"Describe the extracted data",context:"editorSidebar",area:!0,remoteValue:e.description}),(0,h.jsx)("span",{})]},_(e))}))}),(0,h.jsx)("div",{className:"_839l992"}),(0,h.jsx)(a.$,{action:u,title:"+ New Data Extraction",className:"_839l993",center:!0})]})})),ye=(0,n.PA)((function(e){var t=e.nodeId,r=(0,s.P)(),n=p(t),i=(0,o.useCallback)((function(e){r.agentEditor.updateNode(t,{node_name:e})}),[]),a=(0,o.useCallback)((function(e){r.agentEditor.updateNode(t,{node_enter_condition:e})}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:R,children:[(0,h.jsx)(A.E,{level:"microtitle",color:"subtle",children:"Function Name"}),(0,h.jsx)(ae,{className:"tbfeq90",remoteValue:null==n?void 0:n.nodeName,placeholder:"function_name>",onDelayedChange:i})]}),(0,h.jsxs)("div",{className:R,children:[(0,h.jsx)(T,{expanded:!0}),(0,h.jsx)(ae,{area:!0,className:"".concat("tbfeq91"),remoteValue:null==n?void 0:n.nodeEnterCondition,placeholder:"Describe the agent's characteristics, i.e. where she's working it, etc.",onDelayedChange:a})]}),(0,h.jsxs)("div",{className:"_16xqro34",children:[(0,h.jsx)(A.E,{level:"tiny",color:"subtle",children:'TIP: Start with "If the user says" and end with ", call this function.'}),(0,h.jsxs)(A.E,{level:"tiny",color:"subtle",children:["Node #",null==n?void 0:n.order]})]}),(0,h.jsx)(me,{nodeId:t,userData:null==n?void 0:n.userData}),(0,h.jsx)("div",{})]})})),pe=(0,n.PA)((function(){var e=(0,s.P)(),t=(0,o.useCallback)((function(t){e.agentEditor.notifyPromptUpdated(t)}),[]);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:R,children:[(0,h.jsx)(A.E,{level:"microtitle",color:"subtle",children:"Agent Prompt"}),(0,h.jsx)(ae,{area:!0,className:"_2o1gyb0",remoteValue:e.agentEditor.prompt,placeholder:"Describe the agent's characteristics, i.e. where she's working it, etc.",onDelayedChange:t})]})})})),be=(0,n.PA)((function(){var e=(0,s.P)().agentEditor.selectedNode,t=p(e),r=y(t).formattedTitle;return t?(0,h.jsx)("aside",{className:"".concat("_16xqro30"," editor-sidebar"),children:(0,h.jsxs)("div",{className:"_16xqro31",children:[(0,h.jsx)("h5",{className:"_16xqro32",children:r}),"start_call"==(null==t?void 0:t.nodeType)&&(0,h.jsx)(pe,{},e),"default"==(null==t?void 0:t.nodeType)&&(0,h.jsx)(ye,{nodeId:e},e),"end_call"==(null==t?void 0:t.nodeType)&&(0,h.jsx)(ye,{nodeId:e},e)]})}):(0,h.jsx)("div",{})})),he=(0,n.PA)((function(){var e=(0,s.P)();return(0,i.KP)((function(t){return t.currentLocation,t.nextLocation,e.agentEditor.syncing})),e.agentEditor.syncing?(0,h.jsx)("div",{className:"_1tza3990",children:"Syncing..."}):(0,h.jsx)(h.Fragment,{})}));function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){Oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Oe(e,t,r){return(t=function(e){var t=function(e){if("object"!=ge(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ge(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ge(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ee=(0,n.PA)((function(){var e=(0,i.g)().id;!function(){var e=(0,s.P)(),t=e.agentEditor.selectedNode,r=(0,o.useRef)(void 0);(0,o.useEffect)((function(){r.current=t}),[t]),(0,o.useEffect)((function(){var t=function(t){var n=r.current,o=document.activeElement;if(o){var i=!1;if(("INPUT"===o.nodeName&&"text"===o.type||"TEXTAREA"===o.nodeName)&&(i=!0),i)return"Escape"===t.key?void o.blur():void 0}return n&&"Escape"===t.key&&e.agentEditor.selectNode(void 0),(t.ctrlKey||t.metaKey)&&t.shiftKey&&"z"===t.key?(t.preventDefault(),void e.agentEditor.redo()):(t.ctrlKey||t.metaKey)&&"z"===t.key?(t.preventDefault(),void e.agentEditor.undo()):(t.ctrlKey||t.metaKey)&&"d"===t.key?(t.preventDefault(),void e.agentEditor.duplicateSelectedNode()):void("Delete"!==t.key&&"Backspace"!==t.key||(t.preventDefault(),n&&e.agentEditor.removeNode(n)))};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[e])}();var t,r,n=(0,o.useMemo)((function(){return{start:function(e){return(0,h.jsx)(U,we(we({},e),{},{draggable:!1}))},node:function(e){return(0,h.jsx)(U,we({},e))},end:function(e){return(0,h.jsx)(U,we({},e))}}}),[]),m=(0,o.useMemo)((function(){return{edge:function(e){return(0,h.jsx)(E,we(we({},e),{},{className:"prevent-selection-loss"}))}}}),[]),y=(0,s.P)(),p=(t=(0,o.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return je(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?je(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=p[0],g=p[1];(0,o.useEffect)((function(){var e=function(e){"Space"===e.code&&g(!0)},t=function(e){"Space"===e.code&&g(!1)};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),(0,o.useEffect)((function(){var e=function(e){!e.target.closest(".prevent-selection-loss")&&e.target.classList.contains("prevent-selection-loss")};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]);var j=(0,s.P)(),x=(0,c.S)("node-id",(function(e,t){j.agentEditor.selectNode(e)}),[j]);!function(e){var t=(0,s.P)();(0,o.useEffect)((function(){e&&t.agentEditor.mountWithAgentId(e)}),[])}(e),function(){var e=(0,s.P)(),t=(0,u.VH)(),r=function(e){var t=(0,s.P)();return(0,v.EW)((function(){return t.agentEditor.nodes.find((function(t){return t.id===e}))})).get()}(e.agentEditor.selectedNode);(0,o.useEffect)((function(){var e=t.getViewport();if(r&&r.measured){var n,o=(0,f.Jo)([r]),i=o.x+o.width/2,a=o.y+o.height/2;e.x=o.x,e.y=o.y;var l=document.querySelector(".editor-sidebar"),c=null!==(n=null==l?void 0:l.getBoundingClientRect().width)&&void 0!==n?n:0;t.setCenter(i+c/2,a,{zoom:1,duration:500})}}),[t,r])}();var w=y.agentEditor,O=(0,o.useCallback)((function(e){var t=e.target.classList.contains("rendered-node")?e.target:e.target.closest(".rendered-node");if(t){var r=t.getBoundingClientRect(),n=r.left+r.width/2,o=t.getAttribute("data-node-id");e.clientX<n?j.agentEditor.setHoveredNode({id:o,side:"left"}):j.agentEditor.setHoveredNode({id:o,side:"right"})}else j.agentEditor.setHoveredNode(void 0)}),[]);return(0,o.useEffect)((function(){return document.addEventListener("mousemove",O),function(){document.removeEventListener("mousemove",O)}}),[O]),(0,h.jsxs)("main",{className:d,children:[(0,h.jsxs)("div",{className:"_1mh5klk2",children:[(0,h.jsx)(a.$,{title:"â†",circle:!0,type:"subtle",to:"/agents"}),(0,h.jsx)(l.g,{})]}),(0,h.jsx)(u.Gc,{nodes:w.nodes,edges:w.edges,onViewportChange:w.handleViewportChange,edgeTypes:m,nodeTypes:n,viewport:w.viewport,onNodesChange:w.onNodesChange,onEdgesChange:w.onEdgesChange,nodesFocusable:!0,nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b,onClick:x,onEdgeDoubleClick:function(e){e.preventDefault(),e.stopPropagation()},onEdgeContextMenu:function(e){e.preventDefault(),e.stopPropagation()},zoomOnScroll:!1,nodeClickDistance:50,panOnScroll:!0,className:"_1mh5klk0",panOnDrag:b,zoomOnDoubleClick:!1,fitView:!0,fitViewOptions:{minZoom:1,maxZoom:1},children:(0,h.jsx)(u.VS,{id:"1",className:d,gap:25,size:2,color:"rgba(0,0,0,0.2)",variant:u._5.Dots})}),(0,h.jsx)(be,{}),(0,h.jsx)(he,{})]})})),Pe=r(1138),Ne=r(3293),Se=(0,n.PA)((function(){var e=(0,s.P)();return(0,Ne._)(),(0,h.jsx)(Pe.Y,{status:e.agents.fetchStatus,keepLoading:!e.fontsLoaded,size:"medium",children:(0,h.jsx)(u.Ln,{children:(0,h.jsx)(Ee,{})})})}))}}]);